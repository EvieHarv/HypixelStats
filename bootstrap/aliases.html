<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Aliases</title>
    <base href="../">

    <!-- Custom fonts for this template-->
    <link href="bootstrap/all.css" rel="stylesheet" type="text/css">
    <link href="bootstrap/css.css" rel="stylesheet">
    <script src="bootstrap/jquery.js"></script>

    <!-- Custom styles for this template-->
    <link href="bootstrap/sb-admin-2.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/ffba1c6df7.js" crossorigin="anonymous"></script>


<!-- 
<style type="text/css">/* Chart.js */
@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}</style></head>
-->

</head><body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="./index.html">
                <div class="sidebar-brand-icon bg-light collapse-inner rounded">
                    <img class='pt-1 pb-1' src="./bootstrap/imgs/logo.png" style='width: 48px;'></img>
                    <div class="sidebar-brand-text mr-2 text-dark">HypixelStats</div>
                </div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" href="./index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Interface
            </div>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities" aria-expanded="false" aria-controls="collapseUtilities">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Player Lists</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Player Lists:</h6>
                        <a class="collapse-item" href="./bootstrap/seen.html">Seen</a>
                        <a class="collapse-item" href="./bootstrap/whitelisted.html">Whitelisted</a>
                        <a class="collapse-item" href="./bootstrap/blacklisted.html">Blacklisted</a>
                        <a class="collapse-item" href="./bootstrap/aliases.html">Aliases/Nick Hider</a>
                        <a class="collapse-item" href="./bootstrap/lookup.html">Stat Lookup</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Settings</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Settings:</h6>
                        <a class="collapse-item" href="./bootstrap/settings.html">Application Settings</a>
                        <a class="collapse-item" href="./bootstrap/api_settings.html">API Settings</a>
                        <a class="collapse-item" href="./bootstrap/external_servers.html">External Servers</a>
                    </div>
                </div>
            </li>

            <hr class="sidebar-divider d-none d-md-block">

            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

            <div class="text-center d-none d-md-inline mb-3" style="margin-top: auto;">
                <style>
                    a.discordLink:hover
                    {
                        color: #7289DA;
                    }
                </style>
                <a class="nav-link collapsed discordLink" href='https://discord.gg/sEgNthDsRD' target='_blank'>
                    <img class="collapse-item" src='./bootstrap/imgs/Discord-Logo-White.png' style="width: 50px;">
                    <h6 class="collapse-header">Join the discord!</h6>
                </a>
            </div>
            
        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
                    <div>Logged in as: <span class='myPlayerName'></span></div>
                    <div class='navbar-item ml-auto small'>Made by <a href='https://www.github.com/EthanHarv/HypixelStats' target="_blank">github.com/EthanHarv</a>.<br>Consider <a target="_blank" href="https://www.patreon.com/EthanHarv">donating</a>!<br>Not associated with Hypixel Inc.</div>
                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div id='infoBarHolder'>
                    </div>

                    <div>
                        Versions: 
                        HypixelStats <script>document.write(require("electron").remote.app.getVersion());</script>,
                        Node <script>document.write(process.versions.node)</script>,
                        Chrome <script>document.write(process.versions.chrome)</script>,
                        and Electron <script>document.write(process.versions.electron)</script>.                
                    </div>
                    <div class="d-sm-flex align-items-center justify-content-between mb-0">
                        <h1 class="h3 mb-2 pb-0 text-gray-800">Aliases/Nick Hider:</h1>
                    </div>
                    <!-- Content Row -->
                    <div class="row mt-0 pt-0 mb-4" style="padding-left: 10px;">
                        <input style="width: 250px;" type="text" class="form-control form-control-user text-danger mr-1 newInput" id="inputNick" placeholder="Nick to Change">
                        <input style="width: 250px;" type="text" class="form-control form-control-user text-success newInput" id="inputReal" placeholder="Real Username">
                        <div style="padding-left: 5px;">
                            <button class="btn btn-success mb-4" type="button" id="addNewAlias">
                                Add Alias
                            </button>
                        </div>
                        <div style='padding-left: 10px;'>
                            <p class='text-secondary' style="margin-top: 7px;">Case Sensitive!</p>
                        </div>
                    </div>
                    <div class="row playerlist">

                    </div>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Content -->
        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top" style="display: none;">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="./bootstrap/jquery.js"></script>
    <script src="./bootstrap/bootstrap.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="./bootstrap/jquery_002.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="./bootstrap/sb-admin-2.js"></script>
<!--
    <-- Page level plugins ->
    <script src="vendor/chart.js/Chart.min.js"></script>

    <-- Page level custom scripts ->
    <script src="js/demo/chart-area-demo.js"></script>
    <script src="js/demo/chart-pie-demo.js"></script>
-->

<script src='./bootstrap/logged_in.js'></script>
<script src='./bootstrap/infoBar.js'></script>
<script src='./bootstrap/jank_darkmode.js'></script>
<script>
    $(function()
    {
        updateList();

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const player = urlParams.get('player')
        if (player)
        {
            // Put name in nick field
            $('#inputNick').val(player);
            $('#inputReal').focus();
            
        }
    });
    function updateList()
    {
        if (store.get('aliases') == undefined)
        {
            store.set('aliases', {});
        }
        var aliases = store.get('aliases');
        $(".playerList").html("");
        Object.keys(aliases).reverse().forEach(function(player){
        if (player !== ""){
        $(".playerList").append('\
            <div class="col-xl-3 col-md-6 mb-4 playerCard" player="' + player + '" uuid="">\
                <div class="card border-left-primary shadow h-100 py-2">\
                    <div class="card-body">\
                        <div class="row no-gutters align-items-center">\
                            <div class="col mr-2">\
                                <div class="font-weight-bold text-primary mb-1">Nick to Change:</div>\
                                <input style="width: 100%;" type="text" class="form-control form-control-user mb-1 text-danger fieldNick" nick="' + player + '" id="nick' + player + '" value="' + player + '">\
                                <div class="font-weight-bold text-primary mb-1">Real Username:</div>\
                                <input style="width: 100%;" type="text" class="form-control form-control-user mb-1 text-success fieldReal" nick="' + player + '" id="real' + player + '" initReal="' + aliases[player] + '" value="' + aliases[player] + '">\
                                <button class="btn btn-danger mb-0 removeAlias" type="button" nick="' + player + '">Remove</button>\
                                <button style="float: right;" class="btn btn-success mb-0 updateAlias" type="button" nick="' + player + '">Update</button>\
                            </div>\
                        </div>\
                    </div>\
                </div>\
            </div>\
        ')}});
        // /^[a-zA-Z_0-9]+$/
        $('.removeAlias').click(function(e)
        {
            delete aliases[e.target.getAttribute('nick')]; // Remove the player
            store.set('aliases', aliases);
            updateList();
        });
        $('.fieldNick').on("keypress", function(e) {
            if (e.keyCode == 13) {
                $('.updateAlias[nick="' + e.target.getAttribute('nick') + '"]').first().click(); // Same thing as clicking the button manually
                return false; // prevent the button click from happening
            }
        });
        $('.fieldReal').on("keypress", function(e) {
            if (e.keyCode == 13) {
                $('.updateAlias[nick="' + e.target.getAttribute('nick') + '"]').first().click(); // Same thing as clicking the button manually
                return false; // prevent the button click from happening
            }
        });
        $('.updateAlias').click(function(e)
        {
            // We intentionally don't check for conflicting reals. It's intended behavior to be able to have multiple nicks mapped to one real, just its so uncommon that normal inputs replace them.
            var oldNick = e.target.getAttribute('nick');
            var newNick = $("#nick" + e.target.getAttribute('nick')).val();
            var oldReal = $("#real" + e.target.getAttribute('nick')).attr('initReal');
            var newReal = $("#real" + e.target.getAttribute('nick')).val();
            console.log(oldNick + ", " + newNick + ", " + oldReal + ", " + newReal);
            if (newNick == "")
            {
                infoBarMessage('text-danger', "Invalid Name", "The name you input for nick is invalid.", 3000);
                return false;
            };
            if (newReal == "")
            {
                infoBarMessage('text-danger', "Invalid Name", "The name you input for real username is invalid.", 3000);
                return false;
            };
            if (!(/^[a-zA-Z_0-9]+$/.test(newNick)))
            {
                infoBarMessage('text-danger', "Invalid Name", "The name you input for nick is invalid.", 3000);
                return false;
            };
            if (!(/^[a-zA-Z_0-9]+$/.test(newNick)))
            {
                infoBarMessage('text-danger', "Invalid Name", "The name you input for real username is invalid.", 3000);
                return false;
            };
            if (oldNick == newNick && oldReal == newReal)
            {
                return false; // Do nothing if it's identical
            }
            if (Object.keys(aliases).includes(newNick) && oldReal == newReal)
            {
                infoBarMessage('text-danger', "Error", "That alias already exists.", 3000);
                return false;
            }
            if (oldNick == newNick)
            {
                // Just the real has changed
                aliases[oldNick] = newReal;
                store.set('aliases', aliases);
                infoBarMessage('text-success', "Success", "The alias was updated.", 1500);
                updateList();
                return true;
            }
            else
            {
                delete aliases[oldNick];
                aliases[newNick] = newReal; 
                store.set('aliases', aliases);
                infoBarMessage('text-success', "Success", "The alias was updated.", 1500);
                updateList();
                return true;
            }
            return;
        });
    }
    $('.newInput').on("keypress", function(e) {
        if (e.keyCode == 13) {
            $('#addNewAlias').click(); // Same thing as clicking the button manually
            return false; // prevent the key input from happening
        }
    });
    $('#addNewAlias').click(function()
    {
        if(addAlias($('#inputNick').val().trim(), $('#inputReal').val().trim()))
        {
            infoBarMessage('text-success', "Success", "Alias Added Successfully", 1500); // Not really consistent with the behavior on the whitelist pages, but I'm keeping it because ¯\_(ツ)_/¯
        }
        $('#inputNick').val("");
        $('#inputReal').val("");
    });
    function addAlias(nick, real)
    {
        var aliases = store.get('aliases');
        if (aliases == undefined) // Literally should be no way for this to happen because it occurs on pageLoad, but I don't trust anything at this point.
        {
            store.set('aliases', {});
        } 
        if (nick == "" || real == "")
        {
            return false;
        };
        if (!(/^[a-zA-Z_0-9]+$/.test(nick)))
        {
            infoBarMessage('text-danger', "Invalid Name", "The name you input for nick is invalid.", 3000);
            return false;
        };
        if (!(/^[a-zA-Z_0-9]+$/.test(real)))
        {
            infoBarMessage('text-danger', "Invalid Name", "The name you input for the username is invalid.", 3000);
            return false;
        };
        if (Object.keys(aliases).includes(nick))
        {
            infoBarMessage('text-danger', "Nick already in use", "You already have that nick set! The existing one has been updated.", 5000);
        };
        var updateNick = undefined;
        Object.keys(aliases).forEach(function(e)
        {
            if (aliases[e] == real)
            {
                updateNick = e;
            }
        });
        if (updateNick !== undefined)
        {
            delete aliases[updateNick];
        }
        aliases[nick] = real;
        store.set('aliases', aliases)
        updateList();
        return true;
    }
</script>
</body></html>